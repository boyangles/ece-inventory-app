<% provide(:title, 'All Items') %>

<div class="center_jumbotron">
  <h2 class="page-header">Items
    <% if is_manager_or_admin? %>
      <%= link_to "Create New Item", new_item_url, :class => "btn btn-primary pull-right" %>
    <% end %>
  </h2>
</div>

<%= render 'searchform' %>

<ul class="nav nav-tabs">
  <li class="active"><a href="#items" data-toggle="tab">Home</a></li>
  <% if is_admin? %>
  <li><a href="#custom-fields" data-toggle="tab">Define Custom Fields</a></li>
  <% end %>
</ul>

<div id="myTabContent" class="tab-content">

  <div class="tab-pane fade active in" id="items">
    <%= will_paginate %>

    <table class="table table-striped table-hover ">
      <thead>
	<tr>
	  <th>Item Name</th>
	  <th>In Stock</th>
	  <th>Model Number</th>
	  <th class="col-lg-4"></th>
	  <th></th>
	  <% if is_manager_or_admin? %>
	    <th></th>
	  <% end %>
	</tr>
      </thead>

      <tbody>
	<%= render @items %>
      </tbody>
    </table>

    <%= will_paginate %>
  </div>

  <% if is_admin? %>
    <div class="tab-pane fade" id="custom-fields">
      <%= form_for :custom_field, url: custom_fields_url, method: 'post' do |cff| %>
        <table class="table table-hover">
          <tbody>
            <% CustomField.all.each do |cf| %>
                <tr>
                  <td><b><%= cf.field_name %></b></td>
                  <td><%= cf.private_indicator ? 'private' : 'public' %></td>
                  <td><%= CustomField.pretty_field_type(cf.id) %></td>
                  <td>
                    <%= link_to cf, method: :delete, data: {confirm: "Are you sure?"}, class: "btn btn-default" do %>
                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                    <% end %>
                  </td>
                </tr>
            <% end %>

            <td><%= cff.text_field :field_name, class: "form-control" %></td>
            <td>Private? <%= cff.check_box :private_indicator, class: "form-control" %></td>
            <td><%= cff.select :field_type, [['Short Text', 'short_text_type'],
                                             ['Long Text', 'long_text_type'],
                                             ['Integer', 'integer_type'],
                                             ['Float', 'float_type']],
            		                     {}, class: "form-control" %></td>
            <td>
              <%= button_tag(type: 'submit', class: "btn btn-primary") do %>
                <span class="glyphicon glyphicon-plus-sign"></span>
              <% end %>
            </td>
            <% end %>
          </tbody>
        </table>
  </div>
  <% end %>
</div>
  

