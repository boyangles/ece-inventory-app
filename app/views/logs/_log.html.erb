<li id="log-<%= log.id %>">

	<span class="user">
		<% if !log.user_id.nil? %>
			<% acting_user = User.find(log.user_id) %>
			<%= link_to acting_user.username, user_path(acting_user) %>
		<% else %>
			Spicy Software Inc.
  	<% end %>
	</span>


	<div class="content">
		<% if log.user? %>
			<% userlog = UserLog.find_by(:log_id => log.id) %>
			<% user = User.find(userlog.user_id) %>
			<% "HAVE TO ALSO QUERY DELETED TABLE!!" %>

			<% if userlog.created? %>
					<%= "created" %>
				<%= link_to user.username, user_path(user) %>
				<%= " with privilege " + userlog.new_privilege %>
			<% elsif userlog.deleted? %>
				<%= "deleted - need to query deleted table tbd" %>
				

		 <% elsif userlog.privilege_updated? %>
				<%= "changed " %>
				<%= link_to user.username, user_path(user) %>
				<%= "'s privilege from " + userlog.old_privilege  + " to " + userlog.new_privilege %>
			<% end %>

		<% elsif log.request? %>
			<% reqlog = RequestLog.find_by(:log_id => log.id) %>
			<% request = Request.find(reqlog.request_id) %>
			<% user = User.find(request.user_id) %>			

			<% if reqlog.placed_order? %>
				placed an <%= link_to "order", request_path(request) %> 
			<% elsif reqlog.approved? %>
				approved
				<%= link_to user.username, user_path(user) %>
				's <%= link_to "request", request_path(request) %>
			<% elsif reqlog.denied? %>
				denied
				<%= link_to user.username, user_path(user) %>
				's <%= link_to "request", request_path(request) %>
			<% elsif reqlog.cancelled? %>
				deleted
				<%= link_to user.username, user_path(user) %>
				's <%= link_to "request", request_path(request) %>
			<% end %>

			for
			<% if request.request_items.empty? %>
				NOTHING wow okay
			<% end %>
			<ul>
				<% request.request_items.each do |req_item| %>
					<% item = Item.find(req_item.item_id) %>
					<li><%= link_to item.unique_name, item_path(item) %>
					: 
					<%= req_item.quantity %></li>	
				<% end %>
			</ul>

		<% elsif log.item? %>
			<% itemlog = ItemLog.find_by(:log_id => log.id) %>
			<% item = Item.find(itemlog.item_id) %>
			
			<% if itemlog.created? %>
				created the <%= link_to item.unique_name, item_path(item) %> 
				with quantity <%= item.quantity %>

			<% elsif itemlog.deleted? %>
				deleted the <%= link_to item.unique_name, item_path(item) %>
				which had quantity <%= item.quantity %>

			<% elsif itemlog.acquired_destroyed_quantity? %>
				<% if (itemlog.quantity_change > 0) %>
					logged the acquisition of <%= itemlog.quantity_change %>
				<% elsif (itemlog.quantity_change < 0) %>
					logged the destruction of <%= 0 - itemlog.quantity_change %>
				<% end %>
				<%= link_to item.unique_name, item_path(item) %>
				to a new total of <%= itemlog.curr_quantity %>
	
			<% elsif itemlog.admin_corr_quantity? %>
					corrected the quantity of <%= link_to item.unique_name, item_path(item) %>
					from <%= itemlog.curr_quality - itemlog.quantity_change %>
					to <%= itemlog.curr_quantity %>

			<% elsif itemlog.desc_updated? %>
					updated <%= link_to item.unique_name, item_path(item) %> with the following changes:
					<ul>
						<% if itemlog.old_name != itemlog.new_name %>
							<li><%= "updated item's unique name from " + itemlog.old_name + " to " + itemlog.new_name %></li>	
						<% end %>
						
						<% if itemlog.old_desc != itemlog.new_desc %>
							<li><%= "updated item's description from " + itemlog.old_desc + " to " + itemlog.new_desc %></li>	
						<% end %>	
							
						<% if itemlog.old_model_num != itemlog.new_model_num %>
							<li><%= "updated item's model number from " + itemlog.old_model_num + " to " + itemlog.new_model_num %></li>	
						<% end %>	
					</ul>


			<% end %>

		<% end %>

	</div>

  <br>
  <span class="timestamp">
    Logged <%= time_ago_in_words(log.created_at) %> ago.
  </span>
  
</li>
