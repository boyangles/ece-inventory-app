<table class="table table-striped table-hover">
	<thead>
		<tr>
			<th>Item Name</th>
			<th class="text-center">Quantity Loaned</th>
			<th class="text-center">Quantity Disbursed</th>
			<th class="text-center">Quantity Returned</th>
			<th></th>
			<th></th>
		</tr>
	</thead>

        <tbody>
		<% request.request_items.each do |req_item| %> 
			<tr>
				<td><%= link_to req_item.item.unique_name, item_path(req_item.item_id) %></td>
				<td class="text-right"><%= req_item.quantity_loan %></td>
				<td class="text-right"><%= req_item.quantity_disburse %></td>
				<td class="text-right"><%= req_item.quantity_return %></td>
				<% if (req_item.quantity_loan > 0) && is_manager_or_admin? %>
					<td><%= render :partial => 'loans/returnquantityform', locals: {request_item: req_item} %></td>
					<td><%= render :partial => 'loans/disbursequantityform', locals: {request_item: req_item} %></td>
				<% else %>
					<td></td>
					<td></td>
				<% end %>

				<!-- TODO: lots more display logic here!! This is currently super incomplete!! -->
				<% if (req_item.quantity_loan > 0) && request.user_id == current_user.id %>
					<% if req_item.loan? %>		
						<td><%= render 'loans/backfillform', request_item: req_item %></td>
					<% elsif req_item.bf_request? %>
						<td><p class="label label-warning">backfill requested</p></td>
					<% elsif req_item.bf_in_transit? %>
						<td><p class="label label-warning">backfill in transit</p></td>
					<% elsif req_item.bf_denied? %>
						<td><p class="label label-danger">backfill denied</p></td>
					<% elsif req_item.bf_failed? %>
						<td><p class="label label-danger">backfill failed</p></td>
					<% elsif req_item.bf_satisfied? %>
						<td><p class="label label-success">backfill satisfied</p></td>
					<% end %>
				<% else %>
					<td></td>
				<% end %>
			</tr>
		<% end %>	
	</tbody>
</table>
